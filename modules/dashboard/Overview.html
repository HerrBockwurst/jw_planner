<div id="WelcomeTXT">==dashboard Welcome== (USER)</div>
<div id="Dashboard_Sysmessage">(SYSMESSAGE)</div>
<br class="floatbreak" />
<div id="Dashboard_Messagebox">(MESSAGEBOX)</div>
<div id="Dashboard_Infotab">(INFOTAB)</div>
<script>
$('#Dashboard_Messagebox').find('a').click(function() {
	$(this).css({position: "absolute"}).slideUp(500);
	$(this).next().slideDown(500);
});

$(function() {
	if($('#Dashboard_Messagebox').html() == '')
		$('#Dashboard_Messagebox').fadeOut(0);
})

function delMessage() {
	displayLoadingBox();
	
	$.post('^PROTO^^HOME^/datahandler/dashboard/delMessage', {mid: $(this).attr('data-msgid')}, function(data) {
		console.log(data);
		testRedirect(data);
		if(!testJSON(data)) {
			displayMessageBox('==errors formSubmit==', false);
			return;
		}
		testError(data, true, false);
		jdata = JSON.parse(data);
		
		$('#Dashboard_Messagebox').html(jdata.html);
		$('#Dashboard_Messagebox').find('button').unbind().bind('click', submitMessage);
		$('.Dashboard_Delbutton').unbind().bind('click', delMessage);
		hideLoadingBox();
		
	});
}

$('.Dashboard_Delbutton').click(delMessage);

function submitMessage() {
	displayLoadingBox();
	
	$.post('^PROTO^^HOME^/datahandler/dashboard/sendMessage', {text: $('#Dashboard_MessageText').val()}, function(data) {
		testRedirect(data);
		if(!testJSON(data)) {
			displayMessageBox('==errors formSubmit==', false);
			return;
		}
		testError(data, true, false);
		jdata = JSON.parse(data);
		
		$('#Dashboard_Messagebox').html(jdata.html);
		$('#Dashboard_Messagebox').find('button').unbind().bind('click', submitMessage);
		$('.Dashboard_Delbutton').unbind().bind('click', delMessage);
		hideLoadingBox();
		
	});
}

$('#Dashboard_Messagebox').find('button').click(submitMessage)
</script>