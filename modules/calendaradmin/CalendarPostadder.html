<div id="CalendarAdmin_Postadder">
	<div class="headline">==calendaradmin GenPosts==</div>
	<label>
		==common From==
		<input type="text" id="iPostAdderFrom" style="width: 70px; text-align: center"/>
	</label>
	<label>
		==common To==
		<input type="text" id="iPostAdderTo"  style="width: 70px; text-align: center"/>
	</label>
	<button style="width: 100%">==calendaradmin GenPosts==</button><br />
	<button style="margin-top: 20px; width: 100%" class="redbutton">==calendaradmin DeleteCalendar==</button>
</div>
<script>
$(function() {
	var FromDate = new Date(),
		FromDay = ('0' + FromDate.getDate()).slice(-2),
		FromMonth = ('0' + (FromDate.getMonth() + 1)).slice(-2),
		From = FromDay + '.' + FromMonth + '.' + FromDate.getFullYear();
	
	var ToDate = new Date(FromDate.getFullYear(), FromDate.getMonth() + 1, 0, 23, 59, 59);
		
	var ToDay = ('0' + ToDate.getDate()).slice(-2);
	var ToMonth = ('0' + (ToDate.getMonth() + 1)).slice(-2);
	var To = ToDay + '.' + ToMonth + '.' + ToDate.getFullYear();
	
	$('#iPostAdderFrom').val(From);
	$('#iPostAdderTo').val(To);
});

function CalendarAdmin_GenPosts() {
	var data = {
		from : $('#iPostAdderFrom').val(),
		to : $('#iPostAdderTo').val(),
		cid : $('#CalendarAdmin_CalSelect').val()
	};
	
	if(	!/\d{1,2}[\.\/\-]\d{1,2}[\.\/\-]\d{4}|\d{1,2}[\.\/\-]\d{1,2}[\.\/\-]\d{2}/.test(data.from) || 
		!/\d{1,2}[\.\/\-]\d{1,2}[\.\/\-]\d{4}|\d{1,2}[\.\/\-]\d{1,2}[\.\/\-]\d{2}/.test(data.to)) {
			displayMessageBox('==errors TimeFormat==');
			return;
	}
	
	displayLoadingBox();
	$.post('^PROTO^^HOME^/datahandler/calendaradmin/genPosts', data, function (data) {
		testRedirect(data);
		if(!testJSON(data)) {
			hideLoadingBox();
			displayMessageBox('==errors formSubmit==', true);
			return;
		}
		if(testError(data, true, false)) {
			hideLoadingBox();
			return;
		}
		
		displayMessageBox('==calendaradmin PostsAdded==');		
		hideLoadingBox();
	});
	
}

function CalendarAdmin_DeleteCal() {
	displayLoadingBox();
	
	$.post('^PROTO^^HOME^/datahandler/calendaradmin/delCalendar', {cid: $('#CalendarAdmin_CalSelect').val()}, function(data) {
		testRedirect(data);
		if(!testJSON(data)) {
			hideLoadingBox();
			displayMessageBox('==errors formSubmit==', true);
			return;
		}
		if(testError(data, true, false)) {
			hideLoadingBox();
			return;
		}		
		
		CalendarAdmin_updateHeadline();
		hideLoadingBox();
	});
}

$('#CalendarAdmin_Postadder').find('button').click(function() {
	if($(this).hasClass('redbutton')) displayMessageBox('==calendaradmin ConfirmCalDel==', false, {yes: '==common yes==', no: '==common no==', callback: CalendarAdmin_DeleteCal});
	else displayMessageBox('==calendaradmin ConfirmCreatePosts==', false, {yes: '==common yes==', no: '==common no==', callback: CalendarAdmin_GenPosts});
})
</script>